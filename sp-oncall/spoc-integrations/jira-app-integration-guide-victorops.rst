Jira App integration for Splunk On-Call
**********************************************************

Requirements
================

* Jira Version Required: Jira Server 7.7.0 - 8.22.6, Jira Cloud
* Splunk On-Call Version Required: Starter, Growth, or Enterprise
* Global Admin privileges are required for the Splunk On-Call
portion of the configuration.*

Configure in Splunk On-Call
=====================================

#. In Splunk On-Call, go to :guilabel:`Integrations` then :guilabel:`API`.
#. Select :guilabel:`New Key*`. 
#. Give the key a description and copy the resulting API key and API ID.

Install the Splunk On-Call Add-On in Jira
==========================================

#. Log in as a Jira administrator, then select Jira administration gear icon then :guilabel:`Manage apps` to go to the Atlassian Marketplace.
#. In the sidebar, select :guilabel:`Find new apps` under the Atlassian Marketplace header.
#. If you are on Jira Server, search for the app "Splunk On-Call for Jira Server." If you are on Jira Cloud, search for the app "VictorOps for Jira Cloud." After you've located the right app, select :guilabel:`Install`.
#. After installation completes, select :guilabel:`Configure`.

Configuring application settings
--------------------------------

#. Insert the API key you generated in VictorOps into the :guilabel:`API Key` field under :guilabel:`Connect to your VictorOps Organization` on VictorOps for Jira Server Configuration page.
#. In the :guilabel:`API ID` field in the same section, insert the API ID you coped in the preceding Configure Splunk On-Call step.
#. Copy the Splunk On-Call org ID displayed in your VictorOps URL. The org ID is at the end of the URL you used to log in: `https://portal.victorops.com/client/<Org_ID>`. Paste the org ID in Jira's :guilabel:`Organization ID` field.
#. Select :guilabel:`Connect`.

A new entry appears in the Connected VictorOps Organizations section with a green VALID flag.

/_images/spoc/1jira.png

Configure Jira project settings
-------------------------------------

The Splunk On-Call add-on must be enabled and configured for each Jira project you want to associate. While multiple projects can
connect to the same Splunk On-Call organization, projects cannot share the same Default Team Escalation Policy.

#. In Jira, select :guilabel:`Projects`.
#. Go to :guilabel:`Project settings` of the project you want to activate for the Splunk On-Call add-on.
#. Select :guilabel:`VictorOps Settings`.
#. Select :guilabel:`Enable VictorOps for this Project`.

The page to displays a list of configurable fields.

Default incident settings
~~~~~~~~~~~~~~~~~~~~~~~~~

#. Under *VictorOps Instance*, select the Splunk On-Call organization you wish to associate with this project.
#. Under *Default Team Escalation Policy*, select the Splunk On-Call Escalation Policy you would like to page when Jira issues create incidents in Splunk On-Call. NOTE: Incoming VictorOps incidents assigned to this Escalation Policy will be the only ones allowed to create issues in your Jira project.
#. Under *Default User*, select the Jira user you wish to designate as Reporter for issues generated by incoming Splunk On-Call incidents.

Incoming issue settings
~~~~~~~~~~~~~~~~~~~~~~~

Splunk On-Call incidents created for a project's *Default Team Escalation Policy* will automatically generate Jira issues. The default type for such issues (Bug, Epic, Story, or Task) is set by selecting the desired option from the **Issue type to use for incoming VictorOps incidents** dropdown.

If you wish to disable such issue creation, deselect the **Allow issues to be created from incidents via the REST API** checkbox.

/_images/spoc/2jira.png

Jira state configuration
~~~~~~~~~~~~~~~~~~~~~~~~

Defining state mapping allows Jira issues to remain synchronized as incidents move through their life cycle in VictorOps.

/_images/spoc/3jira.png

Create a Splunk On-Call incident within Jira
--------------------------------------------------

Currently, Splunk On-Call incidents can only be created from the Jira issue view.

#. Click **More** > **Create VictorOps Incident**. A preview of the Splunk On-Call incident card will display, using the project's *Default Team Escalation Policy*. Note: For Jira Cloud, the More button is an ellipsis button.
#. You may select a different escalation policy from the *VictorOps Team Escalation Policy* dropdown. You may also use the *Additional Users* dropdown to optionally include additional users for response. Note that adding users to an incident will *not* create a “Multi-Responder incident” in Splunk On-Call.
#. Click **Create Incident** to generate a Splunk On-Call incident. This will then display a *Triggered* Splunk On-Call incident card under the *VictorOps* section in the lower right frame of the issue view.
#. Click the incident card's **Incident Details** link to display the incident in Splunk On-Call in a new browser tab.

/_images/spoc/4jira.png
